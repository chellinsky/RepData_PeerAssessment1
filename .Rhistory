setwd("~/Documents/Coursera/DataScience/workspace/RepData_PeerAssessment1")
dir()
unzip("activity.zip")
dir()
read.csv("activity.csv")
activity <- read.csv("activity.csv")
head(activity)
tail(activity)
str(activity)
hist(activity)
?hist
hist(activity$steps, breaks=activity$date)
str(as.Date(activity$date))
activity$date <- as.Date(activity$date)
hist(activity$steps, breaks=activity$date)
hist(activity$steps)
?hist
library(dplyr)
activity_by_date <- group_by(activity, date)
summarize(activity_by_date)
str(activity_by_date)
?group_by
summarize(activity_by_date, mean(steps))
?mean
summarize(activity_by_date, mean(steps, na.rm=TRUE))
activity_by_date[activity_by_date$date=as.Date("2012-10-01"), ]
activity_by_date[activity_by_date$date==as.Date("2012-10-01"), ]
activity_by_date[activity_by_date$date==as.Date("2012-10-01") & is.na(activity_by_date$steps), ]
activity_by_date[activity_by_date$date==as.Date("2012-10-01") & !is.na(activity_by_date$steps), ]
summarize(activity_by_date, mean(steps, na.rm=TRUE))
summarize(activity_by_date, mean(steps))
hist(summarize(activity_by_date, mean(steps)))
summarize(activity_by_date, sum(steps))
summarize(activity_by_date, sum(steps, na.rm = TRUE))
total_steps <- summarize(activity_by_date, sum(steps, na.rm = TRUE))
str(total_steps)
hist(total_steps$`sum(steps, na.rm = TRUE)`)
?hist
cnames(total_steps)
names(total_steps)
names(total_steps)[2]
names(total_steps)[2] <- "sum"
names(total_steps)
hist(total_steps$date)
hist(total_steps$date, breaks = total_steps$sum)
hist(total_steps$sum, breaks = total_steps$date)
hist(total_steps$sum
)
hist(total_steps$sum, xlab = "Total Steps on a Given Day", main = "Histogram of Total Steps on a Given Day")
hist(total_steps$sum, xlab = "Total Steps on Each Day", main = "Histogram of Total Steps on Each Day")
activity_by_interval <- group_by(activity, interval)
mean_steps <- summarize(activity_by_interval, mean(steps))
mean_steps <- summarize(activity_by_interval, mean(steps, na.rm = TRUE))
names(mean_steps)[2] <- "mean"
?plot
plot(mean_steps$interval, mean_steps$mean, type = "l")
plot(mean_steps$interval, mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Days", main = "Mean Number of Steps at 5-Minute Intervals")
?max
max(mean_steps$mean)
mean_steps[mean_steps == max(mean_steps$mean), ]
mean_steps[mean_steps$mean == max(mean_steps$mean), ]
mean_steps[mean_steps$mean == max(mean_steps$mean), 1]
?count
count(activity[is.na(activity$date), 1])
str(activity)
activity[is.na(activity$date), 1]
activity[is.na(activity$interval), 1]
activity[is.na(activity$steps), 1]
count(activity[is.na(activity$steps), 1])
activity[is.na(activity$steps), 2]
lenght(activity[is.na(activity$steps), 2])
length(activity[is.na(activity$steps), 2])
length(activity[is.na(activity$date), 3])
length(activity[is.na(activity$interval), 1])
activity[is.na(activity$steps), 3]
mean_steps[activity[is.na(activity$steps), 3] == mean_steps$interval, 2]
tempvar <- mean_steps[activity[is.na(activity$steps), 3] == mean_steps$interval, 2]
tempvar[1]
tempvar[[1]
]
activity[is.na(activity$steps), ]
head(activity[is.na(activity$steps), ])
head(activity[is.na(activity$steps), ], n = 50)
head(activity[is.na(activity$steps), ], n = 150)
tempvar <- (activity[is.na(activity$steps), ], n = 150)
tempvar <- activity[is.na(activity$steps), ]
tail(tempvar, n = 25)
tempvar[17567]
tempvar[17567, ]
tempvar[2304, ]
tempvar["17567", ]
tempvar["17567", "interval"]
mean_steps["interval" == tempvar["17567", "interval"], "interval"]
mean_steps[mean_steps$interval == tempvar["17567", "interval"], "interval"]
as.integer(mean_steps[mean_steps$interval == tempvar["17567", "interval"], "interval"])
as.integer(mean_steps[mean_steps$interval == tempvar[, "interval"], "interval"])
mean_steps[mean_steps$interval == tempvar[, "interval"], "interval"]
tempvar2 <- mean_steps[mean_steps$interval == tempvar[, "interval"], "interval"]
head(tempvar2)
str(tempvar2)
tempvar2[ , "interval"]
tempvar2 <- mean_steps[mean_steps$interval == tempvar[, "interval"], "mean"]
str(tempvar2)
tempvar2$mean
str(tempvar)
str(mean_steps)
merge(tempvar, mean_steps, by.x = "interval", by.y = "interval")
head(merge(tempvar, mean_steps, by.x = "interval", by.y = "interval"))
tempvar2 <- mutate(activity, new_steps = if(is.na("steps") mean_steps[mean_steps$interval == "interval", 2]))
tempvar2 <- mutate(activity, new_steps = if(is.na("steps")) mean_steps[mean_steps$interval == "interval", 2]))
?if
())
tempvar2 <- mutate(activity, new_steps = if(is.na("steps")){mean_steps[mean_steps$interval == "interval", 2]}))
tempvar2 <- mutate(activity, new_steps = if(is.na("steps")){mean_steps[mean_steps$interval == "interval", 2]})
tempvar2 <- mutate(activity, new_steps = if(is.na(steps)){mean_steps[mean_steps$interval == interval, 2]})
imputesteps <- function(x) {
missing <- is.na(x$steps)
imputed <- x
imputed[missing, "steps"] <- 0
return(imputed)
}
imputesteps(activity)
tempvar2 <- imputesteps(activity)
tempvar2[tempvar2$steps == 0, ]
imputesteps <- function(x) {
missing <- is.na(x$steps)
imputed <- x
imputed[missing, "steps"] <- -9990
return(imputed)
}
tempvar2 <- imputesteps(activity)
tempvar2[tempvar2$steps == 0, ]
tempvar2[tempvar2$steps == -9990, ]
View(tempvar)
missing <- is.na(activity$steps)
imputed <- activity
imputed[missing, "steps"]
imputed[missing, "steps"] <- -9990
imputed[missing, "steps"]
imputed[imputed$steps == -9990, "interval"]
missing_intv <- imputed[missing, "interval"]
missing_intv
missing_mean_steps <- mean_steps[mean_steps$interval == missing_intv, 2]
missing_mean_steps
missing_mean_steps <- as.integer(mean_steps[mean_steps$interval == missing_intv, 2])
missing_mean_steps <- mean_steps[mean_steps$interval == missing_intv, 2]
missing_mean_steps[, 1]
missing_mean_steps[, "mean"]
unlist(missing_mean_steps)
tail(missing_mean_steps)
missing_intv
missing_mean_steps <- merge(x, y)
missing_mean_steps <- merge(missing_intv, mean_steps, by.y = "interval")
missing_mean_steps <- merge(missing_intv, mean_steps)
str(missing_mean_steps)
?merge
missing_mean_steps <- merge(missing_intv, mean_steps, by = intersect(missing_intv, mean_steps$interval))
dim(missing_intv)
str(missing_intv)
str(mean_steps$interval)
?join
left_join(missing_intv, mean_steps, by = intersect(missing_intv, mean_steps$interval))
left_join(missing_intv, mean_steps)
left_join(missing_intv, mean_steps$interval)
for(step in activity$steps) {}
for(step in activity$steps) {
if(is.na(step)){
step <- -9999
}
}
View(activity)
alteredactivity <- activity
imputedactivity <- activity
for(item in imputedactivity) {
if(is.na(item$steps)){
item$steps <- -9999
}
}
i <- 0
for(item in imputedactivity$steps) {
if(is.na(item)){
imputedactivity[i, "steps"] <- -9999
}
i += 1
}
View(tempvar2)
View(imputedactivity)
i <- 0
for(item in imputedactivity$steps) {
if(is.na(item)){
imputedactivity[i, "steps"] <- -9999
}
i <- 1 + i
}
i <- 0
for(item in imputedactivity$steps) {
if(is.na(item)){
imputedactivity[i, "steps"] <- mean_steps[imputedactivity[i, "interval"] == mean_steps$interval, 2]
}
i <- 1 + i
}
imputedactivity <- activity
i <- 0
for(item in imputedactivity$steps) {
if(is.na(item)){
imputedactivity[i, "steps"] <- mean_steps[imputedactivity[i, "interval"] == mean_steps$interval, 2]
}
i <- 1 + i
}
?rm
rm(imputed)
weekday(imputedactivity$date)
weekdays(imputedactivity$date)
dayofweek <- weekdays(imputedactivity$date)
if(dayofweek == "Sunday" | dayofweek == "Saturday") {
dayofweek <- "weekend"}
head(dayofweek)
str(dayofweek)
as.factor(dayofweek)
imputedactivity <- cbind(imputedactivity, dayofweek)
View(imputedactivity)
i <- 0
for(item in imputedactivity$dayofweek) {
if(item == "Sunday" | item == "Saturday"){
imputedactivity[i, "dayofweek"] <- "weekend"
}
else{
imputedactivity[i, "dayofweek"] <- "weekday"
}
i <- 1 + i
}
warnings()
str(imputedactivity)
imputedactivity <- cbind(imputedactivity, dayofweek)
imputedactivity <- imputedactivity[, c(1:3, 5)]
i <- 0
for(item in imputedactivity$dayofweek) {
if(item == "Sunday" | item == "Saturday"){
imputedactivity[i, "dayofweek"] <- "weekend"
}
i <- 1 + i
}
imputedactivity <- cbind(imputedactivity, dayofweek)
imputedactivity <- imputedactivity[, c(1:3, 5)]
str(imputedactivity)
as.character(imputedactivity$dayofweek)
imputedactivity$dayofweek <- as.character(imputedactivity$dayofweek)
i <- 0
for(item in imputedactivity$dayofweek) {
if(item == "Sunday" | item == "Saturday"){
imputedactivity[i, "dayofweek"] <- "weekend"
}
else{
imputedactivity[i, "dayofweek"] <- "weekday"
}
i <- 1 + i
}
str(imputedactivity)
str(as.factor(imputedactivity$dayofweek))
imputedactivity <- imputedactivity[1:17567, ]
str(as.factor(imputedactivity$dayofweek))
imputedactivity$dayofweek <- as.factor(imputedactivity$dayofweek)
str(imputedactivity)
??mfrow
par(mfrow = 2)
par(mfrow = c(2))
par(mfrow = c(2,1))
imputedactivity_by_interval <- group_by(imputedactivity, interval)
y_mean_steps <- summarize(imputedactivity_by_interval[, "dayofweek" == "weekday"], mean(steps, na.rm = TRUE))
names(day_mean_steps)[2] <- "mean"
day_mean_steps <- summarize(imputedactivity_by_interval[, "dayofweek" == "weekday"], mean(steps, na.rm = TRUE))
names(day_mean_steps)[2] <- "mean"
day_mean_steps <- summarize(imputedactivity_by_interval["dayofweek" == "weekday", ], mean(steps, na.rm = TRUE))
names(day_mean_steps)[2] <- "mean"
end_mean_steps <- summarize(activity_by_interval["dayofweek" == "weekend", ], mean(steps, na.rm = TRUE))
names(end_mean_steps)[2] <- "mean"
par(mfrow = c(2,1))
plot(day_mean_steps$interval, day_mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Weekdays", main = "Mean Number of Steps at 5-Minute Intervals for Weekdays")
plot(end_mean_steps$interval, end_mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Weekend Days", main = "Mean Number of Steps at 5-Minute Intervals for Weekends")
View(day_mean_steps)
View(imputedactivity_by_interval)
View(imputedactivity_by_interval)
summarize(imputedactivity_by_interval["dayofweek" == "weekday", ], mean(steps, na.rm = TRUE))
imputedactivity_by_interval["dayofweek" == "weekday", ]
View(imputedactivity_by_interval)
str(imputedactivity_by_interval)
imputedactivity_by_interval["dayofweek" == 1, ]
imputedactivity_by_interval[imputedactivity_by_interval$dayofweek == 1, ]
imputedactivity_by_interval[imputedactivity_by_interval$dayofweek == "weekday", ]
day_mean_steps <- summarize(imputedactivity_by_interval[imputedactivity_by_interval$dayofweek == "weekday", ], mean(steps, na.rm = TRUE))
names(day_mean_steps)[2] <- "mean"
end_mean_steps <- summarize(imputedactivity_by_interval[imputedactivity_by_interval$dayofweek == "weekend", ], mean(steps, na.rm = TRUE))
names(end_mean_steps)[2] <- "mean"
par(mfrow = c(2,1))
plot(day_mean_steps$interval, day_mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Weekdays", main = "Mean Number of Steps at 5-Minute Intervals for Weekdays")
plot(end_mean_steps$interval, end_mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Weekend Days", main = "Mean Number of Steps at 5-Minute Intervals for Weekends")
# Chunk 1
library(dplyr)
# Chunk 2
unzip("activity.zip")
# Chunk 3
activity <- read.csv("activity.csv")
# Chunk 4
str(activity)
# Chunk 5
activity$date <- as.Date(activity$date)
activity_by_date <- group_by(activity, date)
# Chunk 6
total_steps <- summarize(activity_by_date, sum(steps, na.rm = TRUE))
names(total_steps)[2] <- "sum"
total_steps
# Chunk 7
hist(total_steps$sum, xlab = "Total Steps on Each Day", main = "Histogram of Total Steps on Each Day")
# Chunk 8
mean(total_steps$sum)
# Chunk 9
median(total_steps$sum)
# Chunk 10
activity_by_interval <- group_by(activity, interval)
# Chunk 11
mean_steps <- summarize(activity_by_interval, mean(steps, na.rm = TRUE))
names(mean_steps)[2] <- "mean"
# Chunk 12
plot(mean_steps$interval, mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Days", main = "Mean Number of Steps at 5-Minute Intervals")
# Chunk 13
mean_steps[mean_steps$mean == max(mean_steps$mean), ]
# Chunk 14
length(activity[is.na(activity$steps), 2])
length(activity[is.na(activity$date), 3])
length(activity[is.na(activity$interval), 1])
# Chunk 15
imputedactivity <- activity
# Chunk 16
i <- 0
for(item in imputedactivity$steps) {
if(is.na(item)){
imputedactivity[i, "steps"] <- mean_steps[imputedactivity[i, "interval"] == mean_steps$interval, 2]
}
i <- 1 + i
}
# Chunk 17
imputedactivity_by_date <- group_by(imputedactivity, date)
imputed_total_steps <- summarize(imputedactivity_by_date, sum(steps, na.rm = TRUE))
names(imputed_total_steps)[2] <- "sum"
hist(imputed_total_steps$sum, xlab = "Imputed Total Steps on Each Day", main = "Histogram of Imputed Total Steps on Each Day")
mean(imputed_total_steps$sum)
median(imputed_total_steps$sum)
# Chunk 18
dayofweek <- weekdays(imputedactivity$date)
# Chunk 19
imputedactivity <- cbind(imputedactivity, dayofweek)
# Chunk 20
i <- 0
for(item in imputedactivity$dayofweek) {
if(item == "Sunday" | item == "Saturday"){
imputedactivity[i, "dayofweek"] <- "weekend"
}
else{
imputedactivity[i, "dayofweek"] <- "weekday"
}
i <- 1 + i
}
imputedactivity$dayofweek <- as.factor(imputedactivity$dayofweek)
imputedactivity_by_interval <- group_by(imputedactivity, interval)
day_mean_steps <- summarize(imputedactivity_by_interval[imputedactivity_by_interval$dayofweek == "weekday", ], mean(steps, na.rm = TRUE))
names(day_mean_steps)[2] <- "mean"
end_mean_steps <- summarize(imputedactivity_by_interval[imputedactivity_by_interval$dayofweek == "weekend", ], mean(steps, na.rm = TRUE))
names(end_mean_steps)[2] <- "mean"
par(mfrow = c(2,1))
plot(day_mean_steps$interval, day_mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Weekdays", main = "Mean Number of Steps at 5-Minute Intervals for Weekdays")
plot(end_mean_steps$interval, end_mean_steps$mean, type = "l", xlab = "5-Minute Interval", ylab = "Mean Number of Steps Across All Weekend Days", main = "Mean Number of Steps at 5-Minute Intervals for Weekends")
View(imputedactivity_by_interval)
View(imputedactivity_by_date)
View(imputedactivity)
str(imputedactivity)
